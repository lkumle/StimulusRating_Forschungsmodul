<!DOCTYPE html>
<html>
    <head>
        <title>Experiment</title> 
		<script src="jspsych-6.0.4/jspsych.js"></script>
		<script src="jspsych-6.0.4/plugins/jspsych-html-keyboard-response.js"></script>
		<script src="jspsych-6.0.4/plugins/jspsych-image-keyboard-response.js"></script>
	    	<script src="jspsych-6.0.4/plugins/jspsych-survey-text.js"></script>
	    	<script src="jspsych-6.0.4/plugins/jspsych-survey-multi-choice.js"></script>
		<script src="jspsych-6.0.4/plugins/jspsych-fullscreen.js"></script>
	    	<script src="jspsych-6.0.4/plugins/jspsych-resize.js"></script>
		<script src="jspsych-6.0.4/plugins/jspsych-html-button-response.js"></script>
		<link href="jspsych-6.0.4/css/jspsych.css" rel="stylesheet" type="text/css"></link>
		<style>
		    dl dd { margin-bottom: 20px; }; /* just for the "bullet points" in the consent part*/
		</style>
    </head>
    <body style="background-color:lightgrey;">
	</body>
	<script>
	
		 /*******************/
		/* Create Timeline */
	       /*******************/
		var timeline = []; 
		
		
		 /*********************/
		/* Create Subject-ID */
	       /*********************/
		var subject_id = jsPsych.randomization.randomID(15);
		
		
		 /************************/
		/* Randomize Conditions */
	       /************************/	
		var b1 = ~~(Math.random()*2) ? "clouds" : "muffins";
		var c1 = ~~(Math.random()*2) ? "gutes" : "schlechtes";
		var c_dict = {	"gutes": "schlechtes","schlechtes": "gutes"}
		var c2 = c_dict[c1]
		var condi_keys = "J = "+c1.replace("es", "");
		var condi_order = b1 + "_first";
		
		
		 /********************************/
		/* Save Subject-ID & Conditions */
	       /********************************/
		jsPsych.data.addProperties({ID: subject_id, condition_order: condi_order, condition_keys: condi_keys});
		


		 /*********************/
		/* All stimulus sets */
	       /*********************/	

		// for test-procedure
		var test_clouds = [
			{stimulus: "<div><img src='test_himmel_2.png' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='test_himmel_3.png' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='test_himmel_4.png' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				}
			];
	
			
		var test_muffins = [
			{stimulus: "<div><img src='test_muffin2.png' width='600' height='400' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='test_muffin3.png' width='600' height='400' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='test_muffin4.png' width='600' height='400' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				}
			];	
		
		// for main procedure
		var clouds_stimuli = [
			{stimulus: "<div><img src='H1.png' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='H2.jpg' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='H3.jpg' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='H4.jpg' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='H5.jpg' width='900' height='600' position:absolute left:50% top:50%></img></div>"
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='H6.jpg' width='900' height='600' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-70%; margin-top:15%;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:70%; margin-top:15%; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				}
			];
		
		var muffins_stimuli = [
			{stimulus: "<div><img src='M1.png' width='600' height='400' position:absolute left:50% top:50%></img></div>"
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"	
				},
			{stimulus: "<div><img src='M2.png' width='600' height='400' position:absolute left:50% top:50%></img></div>"
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='M3.png' width='600' height='400' position:absolute left:50% top:50%></img></div>"
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='M4.png' width='600' height='400' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='M5.png' width='600' height='400' position:absolute left:50% top:50%></img></div>"
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				},
			{stimulus: "<div><img src='M6.png' width='600' height='400' position:absolute left:50% top:50%></img></div>" 
				+ "<div style='position:absolute; margin-left:-630px; margin-top:237px;text-align:center;width:100%'><p style='font-size:22px; '>"+c2.replace("es", "")
				+"<br><small>F</small></p></div>"
				+ "<div style='position: absolute; margin-left:630px; margin-top:237px; text-align:center;width:100%'><p style='font-size:22px; '>"+c1.replace("es","")+"<br><small>J</small></p></div>"
				}
			];
		
		
		
		
		 /*********************/
		/* Task Instructions */
	       /*********************/
		
		var instruct_clouds = "<p style='font-size:26px;'>In diesem Experiment werden Ihnen Himmelsbilder gezeigt.</p>"+
			"<p style='font-size:26px;'>Ihre Aufgabe ist es, zu bewerten, ob es sich Ihrer Meinung nach "+
			"um gutes oder schlechtes Wetter handelt.</p>"+
			"<p style='font-size:26px;'>Handelt es sich Ihrer Meinung nach um <strong>" + c1 +
			"</strong> Wetter, druecken Sie die Taste <strong>J</strong> mit dem rechten Zeigefinger.</p>"+
			"<p style='font-size:26px;'>Handelt es sich Ihrer Meinung nach um <strong>" + c2 +
			"</strong> Wetter, druecken Sie die Taste <strong>F</strong> mit dem linken Zeigefinger.</p>"+
 			"<p style='font-size:26px;'>Fuer Ihre Antwort gibt es keine Zeitbegrenzung.</p>"+
 			"<div style='float: middle;'><img src='test_himmel_2.png'></img>" +
 			"</div>"+
			"<p style='font-size:26px;'>Druecken Sie eine beliebige Taste, um mit einigen Uebungsdurchgaengen zu beginnen.</p>";
		
		var instruct_muffins = "<p style='font-size:26px;'>In diesem Experiment werden Ihnen Bilder von Muffins gezeigt.</p>"+
		    	"<p style='font-size:26px;'>Ihre Aufgabe ist es, zu bewerten, ob es dem Muffin Ihrer Meinung nach "+
		    	"gut oder schlecht geht.</p>"+
		    	"<p style='font-size:26px;'>Geht es dem Muffin Ihrer Meinung nach <strong>" + c1.replace("es", "") +
			"</strong>, druecken Sie die Taste <strong>J</strong> mit dem rechten Zeigefinger.</p>"+
			"<p style='font-size:26px;'>Geht es dem Muffin Ihrer Meinung nach <strong>" + c2.replace("es", "") +
			"</strong>, druecken Sie die Taste <strong>F</strong> mit dem linken Zeigefinger.</p>"+
 			"<p style='font-size:26px;'>Fuer Ihre Antwort gibt es keine Zeitbegrenzung.</p>"+
 			"<div style='float: middle;'><img src='test_muffin1.png'></img>" +
 			"</div>"+
			"<p style='font-size:26px;'>Druecken Sie eine beliebige Taste, um mit einigen Uebungsdurchgaengen zu beginnen.</p>";
		
		
	  	 /***********************/
		/* Consent Information */
	       /***********************/
		
		var consent_information = "<div style='margin-bottom:20px; font-size:16px;'><h2>Einwilligung und Studieninformationen</h2>"+
			"<dl><dt><strong>Studieninformation</strong></dt><dd>In dieserm kleinen Experiment werden Ihnen Bilder von Wolken und Muffins gezeigt, welche Sie via Tastendruck bewerten sollen. Ausserdem wuerden wir am Ende gerne Ihr Alter und Ihr Geschlecht erfahren.</dd>"
			+ "<dt><strong>Wissenschaftliche Ziele</strong></dt>"+
			"<dd>Dieses kleine Experiment dient der Auswahl geeigneter Bilder fuer eine Studie zur Interpretation uneindeutiger Inhalte.</dd><dt><strong>Persoenlicher Nutzen</strong></dt>"+
			"<dd>Die Teilnahme an diesem Experiment kann leider nicht entlohnt werden. Wir danken Ihnen umso mehr vielmals fuer Ihre Teilnahme. </dd>"+
			"<dt><strong>Freiwilligkeit</strong></dt>"+
			"<dd>Die Teilnahme an diesem Experiment ist vollkommen freiwillig. Sie koennen Ihre Teilnahme jederzeit ohne Angabe von Gruenden beenden, ohne dass Ihnen dadurch Nachteile entsehen. Druecken Sie hierfuer jederzeit die Taste 'q'. In diesem Fall endet das Experiment augenblicklich ohne irgendwelche Ihrer Angaben zu speichern.</dd>"+
			"<dt><strong>Datensicherung und Datenschutz</strong></dt>"+
			"<dd>Im Zuge dieses Experiments werden <i>keinerlei</i> personen-identifizierende Daten (wie etwa IP-Adressen oder aehnliches) erhoben. Das heisst, die Daten (z. B. Ihr Tastendruck bei jedem der gezeigten Bilder) werden in rein anonymisierter Form abgespeichert und erlauben keine Rueckschluesse auf Ihre Person oder Ihren Standort. Die Daten werden auf einem lokalen Server an der Universitaet Frankfurt in einem Ordner gespeichert, der ausschliesslich den Studienmitarbeitern zugaenglich ist. </dd>"+
			"</dl></div>"+"<div style='font-size:16px;'><p style='margin:0px; font-size:16px;'><br><br><i>Wenn Sie mit den oben stehenden Informationen einverstanden sind, klicken Sie bitte auf 'Einverstanden',  um an diesem Experiment teilzunehmen.</i></p><p style='margin:0px; font-size:16px;'><i>Wenn Sie mit den oben stehenden Informationen nicht einverstanden sind, klicken Sie bitte auf 'Nicht einverstanden', um das Experiment abzubrechen.</i></p></div>";

			
			
			
	   /************************/
		/**** Resize-Instruct ***/
	 /************************/		
		
		var resize_text = "<p style='font-size:16px;'>Um die Bilder, welche Sie gleich sehen werden, in der fuer Ihren Bildschirm richtigen Groesse darstellen zu koennen,</p>" + "<p style='font-size:16px;'>bitten wir Sie, sich nun eine Bankkarte zur Hand zu nehmen. Halten Sie die Karte direkt vor das blaue Feld</p>"+
			"<p style='font-size:16px;'> und ziehen Sie die rechte untere Ecke des Feldes so weit, dass es der Groesse Ihrer Bankkarte entspricht.</p>"+
			"<p style='margin-top: 30px; font-size:16px'>Wenn Sie bereit sind, klicken Sie bitte auf 'Weiter'.</p>"
	
			
			
	   /************************/
		/* Concentrate-Instruct */
	 /************************/		
		var concentrate_text = "<p style='font-size:26px;'>Fuer unsere Untersuchung ist es wichtig, dass Sie die folgenden Aufgaben <strong>ungestoert</strong> bearbeiten koennen.</p>" + "<p style='font-size:26px;'>Wir bitten Sie daher, sich fuer die Bearbeitung der folgenden beiden Aufgaben an einen ruhigen Ort zu begeben</p><p style='font-size:26px;'> und nach Moeglichkeit keine weiteren Aktivitaeten parallel zu verfolgen.</p><p style='font-size:26px;'> <strong>Vielen Dank!!</strong></p>"+ "<p style='font-size:26px;'>Klicken Sie auf 'Ich bin bereit.', um mit der ersten Aufgabe zu starten.</p>";

						
		
		 /*************************/
		/*Define trial components*/
	 /*************************/
		
		// Fullscreen info
		var start_fullscreen = {
			type: 'fullscreen',
			fullscreen_mode:true,
			message: "<div>Bitte klicken Sie auf 'Weiter', um das Experiment im Vollbild-Modus zu sehen.</div>"+
			"<div>Der Vollbild-Modus endet nach Ende des Experiments automatisch.</div>",
			button_label: "Weiter"
		};
		
		// Welcome trial
		var welcome = {
		    type: "html-keyboard-response", 
			stimulus: "<h4><p style='font-size:16px;'>Herzlich Willkommen! Vielen Dank fuer Ihre Teilnahme an diesem Experiment.</p></h4>" +
			"<p style='font-size:16px;'>Dieses Experiment besteht aus zwei Aufgaben.</p>"+
			"<p style='font-size:16px;'>Druecken Sie eine beliebige Taste, um fortzufahren.</p>"
			};	
			
		// Study Information and Consent
		var consent_info = {
			type: 'html-button-response',
			stimulus: consent_information,
			margin_vertical: '2px',
			choices: ["Nicht einverstanden.", "Einverstanden."],
			on_finish: function(data){
				if(data.button_pressed == "0"){
					jsPsych.endExperiment("<div>Sie haben sich entschieden, das Experiment abzubrechen. Nichts der von Ihnen 						während Ihrer Teilnahme gesammelten Daten wurde gespeichert.<div/><div>Vielen Dank für Ihre (teilweise) 						Teilnahme!</div>")}
				}
			};
			
			
		// Resize trial
		var resize = {
			type: 'resize',
			item_width: 3 + 3/8,
			item_height: 2 + 1/8,
			prompt: resize_text,
			pixels_per_unit: 150,
			button_label: "<p style='font-size:16px;'>Weiter</p>"
			};	
			
			
		// concentrate trials
		var concentrate = {
			type: "html-button-response", 
			stimulus: concentrate_text,
			margin_vertical:'15px',
			choices:["<p style='font-size:20px'>Ich bin bereit.</p>"]
			};	
		
		
			
		// Instruction trial
		var instructions = {
			type: 'html-keyboard-response',
			stimulus: instruct_clouds
			};
		
		// Fixation cross
		var fixation = {
			type: 'html-keyboard-response',
			stimulus: '<div style="font-size:100px;">+</div>',
			choices: ["q"],
			trial_duration: 500,
			on_finish: function(data){
				if(data.key_press == 81){ // 81 is js key code for "q", which we use as an exit button
					jsPsych.endExperiment("<div><p style='font-size:30px;'>Sie haben sich entschieden, das Experiment abzubrechen. Es wurden keine Ihrer gemachten Angaben gespeichert.</p></div><div><p style='font-size:30px;'>Vielen Dank fuer Ihre (teilweise) Teilnahme!</p></div>")
					} // end if-statement	
				} // end function(data)
			};

		// Task Choice
		var choice = {
			type: "html-keyboard-response",
			stimulus: jsPsych.timelineVariable('stimulus'),
			choices: ['f', 'j', 'q'], // corresponding to 70, 74 and 81 in js key code, respectively (and the key code is logged)
			on_finish: function(data){
				if(data.key_press == 81){ // 81 is js key code for "q", which we use as an exit button
					jsPsych.endExperiment("<div><p style='font-size:30px;'>Sie haben sich entschieden, das Experiment abzubrechen. Es wurden keine Ihrer gemachten Angaben gespeichert.</p></div><div><pstyle='font-size:30px;'>Vielen Dank fuer Ihre (teilweise) Teilnahme!</p></div>")

					} // end if-statement	
				} // end function(data)
			};
		
		// ITI
		var iti = {
			type: 'html-keyboard-response', 
			stimulus: '<div></div>', 
			choices: ["q"],
			trial_duration: 500,
			on_finish: function(data){
				if(data.key_press == 81){ // 81 is js key code for "q", which we use as an exit button
					jsPsych.endExperiment("<div><p style='font-size:30px;'>Sie haben sich entschieden, das Experiment abzubrechen. Es wurden keine Ihrer gemachten Angaben gespeichert.</p></div><div><p style='font-size:30px;'>Vielen Dank fuer Ihre (teilweise) Teilnahme!</p></div>")
					} // end if-statement	
				} // end function(data)	
			};

		// Practice Trials (combined)
		var test_procedure = {
			timeline: [fixation, choice, iti],
			timeline_variables: test_clouds, 
			randomize_order: true,
			};
	
		// End-of-Practice-Trials Trial
		var end_of_practice = {
			type: "html-keyboard-response", 
			stimulus: "<p style='font-size:30px;'>Das waren die Uebungsdurchgaenge.</p>" +
			"<p style='font-size:30px;'>Druecken Sie eine beliebige Taste, um mit der eigentlichen Aufgabe zu beginnen.</p>"
			};
	
		// Experiment Trials (combined)
		var procedure = {
			timeline: [fixation, choice, iti],
			timeline_variables: clouds_stimuli, 
			randomize_order: true,
		};
		
		
		// Start Task 2
		var pause = {
		    type: "html-keyboard-response", 
			stimulus: "<p style='font-size:30px;'>Die erste Aufgabe ist geschafft, vielen Dank!</p><p style='font-size:30px;'> Gerne koennen Sie eine kleine Pause einlegen, bevor Sie mit der zweiten Aufgabe starten.</p>"+ "<p style='font-size:30px;'><br><br><br>Wenn Sie bereit sind, druecken Sie eine beliebige Taste, um mit der zweiten Aufgabe fortzufahren.</p>"
			};	
			
		
		// Clone/Copy instructions, procedure and test_procedure for SECOND BLOCK
		var instructions2 = Object.assign({}, instructions);
		var test_procedure2 = Object.assign({}, test_procedure);
		var procedure2 = Object.assign({}, procedure);
		
		// Age question
		var age = {
			type: "survey-text",
			questions: [{prompt: "<p style='font-size:20px;'>Geben Sie hier bitte Ihr Alter an:</p>", rows:1, columns:6}], 
			button_label: "<p style='font-size:16px;'>Weiter</p>"
		};
		
		// Gender question
		var options_gender = ["<strong>maennlich</strong>", "<strong>weiblich</strong>"] ;// ["maennlich", "weiblich"]; 
		var gender = {
			type: "survey-multi-choice",
			questions: [{prompt: "<p style='font-size:26px;'>Geben Sie hier bitte Ihr Geschlecht an:</p>", options: options_gender}],
			button_label: "Weiter" //"<p>Weiter</p>" --> doesn't work
		};
		
		
		// Ask if subjects got disturbed during the experiment
		var ask_concentrate = {
			type: "html-button-response",
			stimulus: "<p style='font-size:26px;'>Konnten Sie die Aufgabe ungestoert bearbeiten?</p>",
			margin_vertical:"25px",
			choices:["<p style='font-size:20px;'>Ja, ich konnte die Aufgabe ungestoert bearbeiten.</p>", "<p style='font-size:20px;'>Nein, ich wurde leider gestoert.</p>"]
		};
		
		
		// End Fullscreen
		var end_fullscreen = {
			type: 'fullscreen',
			fullscreen_mode: false 
		};
		
		// Goodbye/End of Experiment
		var goodbye = {
			type: "html-keyboard-response", 
			stimulus: "<p style='font-size:25px;'>Das Experiment ist nun zu Ende. Vielen Dank fuer Ihre Teilnahme!</p>" +
			"<p style='font-size:25px;'>Druecken Sie eine beliebige Taste, um die Aufgabe zu beenden. Anschliessend koennen Sie das Browser-Fenster schliessen.</p>"
		};
		
		
		
		
		 /*******************/
		/* CREATE TIMELINE */
	       /*******************/
		
		timeline.push(start_fullscreen);	
		timeline.push(welcome);
		timeline.push(consent_info);
		timeline.push(resize);
		timeline.push(concentrate);
		
		//MODIFY FIRST BLOCK (instructions, test_procedure, procedure) depending on condition:	
		if(b1 == "muffins"){
			instructions.stimulus = instruct_muffins;
			test_procedure.timeline_variables = test_muffins;
			procedure.timeline_variables = muffins_stimuli;
		};
		
		timeline.push(instructions);
		timeline.push(test_procedure);
		timeline.push(end_of_practice); // stays the same for all conditions
		timeline.push(procedure);
		
		//Pause between tasks
		timeline.push(pause);
		
		
		//MODIFY SECOND BLOCK: (instructions2, test_procedure2, procedure2) depending on condition:	
		if(b1 == "muffins"){
			instructions2.stimulus = instruct_clouds;
			test_procedure2.timeline_variables = test_clouds;
			procedure2.timeline_variables = clouds_stimuli;
		} else 	if(b1 == "clouds"){
			instructions2.stimulus = instruct_muffins;
			test_procedure2.timeline_variables = test_muffins;
			procedure2.timeline_variables = muffins_stimuli;				
		}	
		
		
		timeline.push(instructions2);
		timeline.push(test_procedure2);
		timeline.push(end_of_practice); // stays the same for all conditions
		timeline.push(procedure2);	
		timeline.push(age);
		timeline.push(gender);
		timeline.push(ask_concentrate);		
		timeline.push(end_fullscreen);
		timeline.push(goodbye);
		
		
		
		 /****************************/
		/* Function for data saving */
	       /****************************/
				
		function saveData(name, data){
		  var xhr = new XMLHttpRequest();
		  xhr.open('POST', 'write_data.php'); // 'write_data.php' is the path to the php file described above.
		  xhr.setRequestHeader('Content-Type', 'application/json');
		  xhr.send(JSON.stringify({filename: name, filedata: data}));
		}
		
		
		 /***********************/
		/* Define outfile name */
	       /***********************/
		var outfile = "ibi_CloudsMuffinsRating_" + subject_id;
		
		
		 /**************************/
		/* Initialise Experiment! */
	       /**************************/
		jsPsych.init({
			timeline:timeline,
			//on_finish:function() {jsPsych.data.displayData();} // use when testing experiment without Web Server running
			on_finish: function(){ saveData(outfile, jsPsych.data.get().csv()); } // use when testing experiment with Web Server running
		});
					
	</script>  
</html>

